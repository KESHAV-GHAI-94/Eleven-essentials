<%- include('./partials/header') %>

<div class="w-full min-h-screen bg-gray-100 px-4 md:px-20 py-10 md:py-20">
  <div class="flex flex-col md:flex-row gap-8 md:gap-10">

    <!-- LEFT : CART ITEMS -->
    <div class="w-full md:w-[35%] space-y-8">

      <% if (user.cart && user.cart.length > 0) { %>
        <% user.cart.forEach(cart => { %>
          <% if (cart.product) { %>

            <!-- CART CARD -->
            <div class="rounded-xl overflow-hidden shadow bg-white">

              <!-- IMAGE -->
              <div
                class="h-64 md:h-80 flex justify-center items-center"
                style="background-color:<%= cart.product.bgcolor %>;"
              >
                <img
                  class="h-48 md:h-[18rem] object-contain"
                  src="data:image/jpeg;base64,<%= cart.product.images.toString('base64') %>"
                  alt=""
                />
              </div>

              <!-- PRODUCT PANEL -->
              <div
                class="flex justify-between items-center px-4 md:px-5 py-3 md:py-4"
                style="background-color:<%= cart.product.panelcolor %>;"
              >
                <h3
                  class="text-lg md:text-xl font-semibold"
                  style="color:<%= cart.product.textcolor %>;"
                >
                  <%= cart.product.name %>
                </h3>

                <div class="flex items-center gap-2 md:gap-3">
                  <button class="w-7 h-7 md:w-8 md:h-8 rounded-full bg-white shadow flex items-center justify-center">
                    <i class="ri-add-line"></i>
                  </button>

                  <span class="px-2 md:px-3 py-1 bg-white rounded-md font-semibold text-sm md:text-base">
                    <%= cart.quantity %>
                  </span>

                  <button class="w-7 h-7 md:w-8 md:h-8 rounded-full bg-white shadow flex items-center justify-center">
                    <i class="ri-subtract-line"></i>
                  </button>
                </div>
              </div>

              <!-- ITEM TOTAL -->
              <div class="flex justify-between items-center px-4 md:px-5 py-3 bg-gray-200">
                <span class="text-base md:text-lg font-medium">Net Total</span>
                <span class="text-base md:text-lg font-semibold">
                  ₹ <%= cart.product.price * cart.quantity %>
                </span>
              </div>

            </div>

          <% } %>
        <% }) %>
      <% } else { %>
        <p class="text-center text-gray-500">Your cart is empty</p>
      <% } %>

    </div>

    <!-- RIGHT : PRICE SUMMARY -->
    <div class="w-full md:w-[65%]">

      <div class="bg-white rounded-xl shadow p-6 md:p-8 md:sticky md:top-24">

        <h3 class="text-xl md:text-2xl font-semibold mb-6">
          Price Summary
        </h3>

        <div class="space-y-4 text-sm md:text-base">
          <div class="flex justify-between">
            <span>Total MRP</span>
            <span>₹ <%= totalMRP %></span>
          </div>

          <div class="flex justify-between">
            <span>Discount on MRP</span>
            <span class="text-green-600">
              - ₹ <%= totalDiscount %>
            </span>
          </div>

          <div class="flex justify-between">
            <span>Platform Fee</span>
            <span>₹ 20</span>
          </div>

          <div class="flex justify-between">
            <span>Shipping Fee</span>
            <span class="text-green-600">FREE</span>
          </div>
        </div>

        <hr class="my-6">

        <div class="flex justify-between items-center">
          <span class="text-lg md:text-xl font-semibold">
            Total Amount
          </span>
          <span class="text-xl md:text-2xl font-bold text-green-600">
            ₹ <%= bill %>
          </span>
        </div>

        <button class="w-full mt-6 md:mt-8 py-3 rounded-lg bg-black text-white font-semibold">
          Proceed to Checkout
        </button>

      </div>

    </div>

  </div>
</div>

<%- include('./partials/footer') %>
